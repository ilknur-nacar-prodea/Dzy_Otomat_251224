sap.ui.define(["./BaseController","sap/ui/model/json/JSONModel","../model/formatter","sap/m/library","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/model/Sorter","sap/ui/Device","sap/ui/core/UIComponent","sap/ui/core/routing/HashChanger"],function(e,t,a,s,r,i,o,n,l,d){"use strict";var g,u;var h;return e.extend("app.DzyOtomat.controller.ConfirmStockReqDetail",{formatter:a,onInit:function(){this.getRouter().getRoute("ConfirmStockReqDetail").attachPatternMatched(this._onObjectMatched,this)},_onObjectMatched:function(e){g=e.getParameter("arguments").trip;u=e.getParameter("arguments").plate;var a=e.getParameter("arguments").req;var s=new t;this.getView().setModel(s,"Detail");this.getModel("Detail").setProperty("/TalepNo",a);this.getModel("ARAC").metadataLoaded().then(function(){var e=this.getModel("ARAC").createKey("AracKabulTalepListSet",{TalepNo:a});this._bindView("/"+e)}.bind(this));this._filterTable(a)},_bindView:function(e){this.getView().byId("kaydetBtn").setEnabled(true)},_filterTable:function(e){var t=new r("TalepNo",i.EQ,e);var a=this.byId("lineItemsList");var s=a.getBinding("items");s.filter([t])},kaydetPress:function(){debugger;var e=this.getOwnerComponent().getModel("ARAC");var t=this.getModel("Detail").getProperty("/TalepNo");var a=this;var s=this;var r=[];r.push(new sap.ui.model.Filter("IvTalepno",sap.ui.model.FilterOperator.EQ,t));e.read("/AracKabulKaydetMalKabulSet",{filters:r,success:function(e,t){var r=e.results.filter(function(e,t){return e.Type==="S"});if(r.length>=1){a.getView().byId("kaydetBtn").setEnabled(false)}s.showMessages(e);sap.ui.core.BusyIndicator.hide()},error:function(e){sap.m.MessageBox.error("Kay�t s�ras�nda hata olu�tu.");sap.ui.core.BusyIndicator.hide()}})},showMessages:function(e){debugger;var t=this;var a=[];var s=e.results;for(var r=0;r<s.length;r++){var i=s[r];var o={MessageType:i.Type,Message:i.Message};a.push(o)}h=new sap.ui.model.json.JSONModel;this.getView().setModel(h,"oMsgModel");this.getView().getModel("oMsgModel").setData(a);if(!this.oMessage){this.oMessage=sap.ui.xmlfragment("app.DzyOtomat.view.fragments.aracKabul.Messages",this);this.getView().addDependent(this.oMessage)}this.oMessage.open();this.getOwnerComponent().getModel("oMsgModel").refresh(true)},onMessageClose:function(){this.oMessage.close()},onNavBack:function(){var e=this.getOwnerComponent().getRouter();e.navTo("ConfirmStockReq",{trip:g,plate:u})}})});